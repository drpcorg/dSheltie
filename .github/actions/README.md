# GitHub Actions –¥–ª—è dSheltie

–≠—Ç–æ—Ç –∫–∞—Ç–∞–ª–æ–≥ —Å–æ–¥–µ—Ä–∂–∏—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π composite action –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å Go –ø—Ä–æ–µ–∫—Ç–∞–º–∏.

## üöÄ –ï–¥–∏–Ω—ã–π Universal Action

### `setup-go-project`

–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Go –ø—Ä–æ–µ–∫—Ç–∞ —Å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–ª—è –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```yaml
- name: Setup Go project
  uses: ./.github/actions/setup-go-project
  with:
    go-version: "1.24.1"
    cache-key-suffix: "my-suffix"
    skip-generate-networks: "false"
    skip-download-deps: "false"
    checkout-repo: "true"
    fetch-depth: "1"
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

- `go-version` - –≤–µ—Ä—Å–∏—è Go (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "1.24.1")
- `cache-key-suffix` - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Å—É—Ñ—Ñ–∏–∫—Å –¥–ª—è –∫–ª—é—á–∞ –∫—ç—à–∞
- `skip-generate-networks` - –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Å–µ—Ç–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "false")
- `skip-download-deps` - –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ø—Ä–∏ –ø–æ–ø–∞–¥–∞–Ω–∏–∏ –≤ –∫—ç—à (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "false")
- `checkout-repo` - –≤—ã–ø–æ–ª–Ω–∏—Ç—å checkout —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "true")
- `fetch-depth` - –≥–ª—É–±–∏–Ω–∞ checkout (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "1")

**–í—ã—Ö–æ–¥—ã:**

- `cache-hit` - –±—ã–ª –ª–∏ –∫—ç—à –Ω–∞–π–¥–µ–Ω
- `go-cache-key` - —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á –∫—ç—à–∞
- `go-version` - —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –≤–µ—Ä—Å–∏—è Go

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —É–º–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏
- ‚úÖ –£—Å–ª–æ–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ cache miss)
- ‚úÖ –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## üéØ –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

### –ö–ª—é—á–∏ –∫—ç—à–∞

–§–æ—Ä–º–∞—Ç: `{OS}-go-{GO_VERSION}-{HASH(go.sum)}-{SUFFIX}`

–ü—Ä–∏–º–µ—Ä—ã:

- `Linux-go-1.24.1-abc123-test`
- `macOS-go-1.23.x-def456-build-macos-latest`

### Fallback –∫–ª—é—á–∏

1. `{OS}-go-{GO_VERSION}-`
2. `{OS}-go-`

### –ö—ç—à–∏—Ä—É–µ–º—ã–µ –ø—É—Ç–∏

- `~/.cache/go-build` - Go build cache
- `~/go/pkg/mod` - Go modules cache

### –õ–æ–≥–∏–∫–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

```
1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ –∫—ç—à–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ go.sum + —Å—É—Ñ—Ñ–∏–∫—Å–∞
2. –ü–æ–ø—ã—Ç–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∫—ç—à–∞
3. –ü—Ä–∏ cache hit: –ø—Ä–æ–ø—É—Å–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
4. –ü—Ä–∏ cache miss: –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
5. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫—ç—à–∞ –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—É—Å–∫–æ–≤
```

## üìä –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- ‚úÖ Shallow clone (`fetch-depth: 1`)
- ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ Go (`cache: true`)
- ‚úÖ –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª–µ–π
- ‚úÖ –£–º–Ω—ã–µ –∫–ª—é—á–∏ –∫—ç—à–∞ —Å fallback
- ‚úÖ –£—Å–ª–æ–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å

- ‚úÖ –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π (`go mod verify`)
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –°—Ç–∞—Ç—É—Å –∫—ç—à–∞ –≤ –≤—ã–≤–æ–¥–µ
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Go –æ–∫—Ä—É–∂–µ–Ω–∏–∏

## üîÑ Workflow –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### –ü—Ä–æ—Å—Ç–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```yaml
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: ./.github/actions/setup-go-project
        with:
          cache-key-suffix: "test"
      - run: make test
```

### –° –º–∞—Ç—Ä–∏—Ü–µ–π

```yaml
jobs:
  test:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest, macos-latest]
        go-version: ["1.24.1", "1.23.x"]
    steps:
      - uses: ./.github/actions/setup-go-project
        with:
          go-version: ${{ matrix.go-version }}
          cache-key-suffix: "test-${{ matrix.os }}"
      - run: make test
```

### –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ jobs

```yaml
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: ./.github/actions/setup-go-project
        with:
          cache-key-suffix: "test"
      - run: make test

  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: ./.github/actions/setup-go-project
        with:
          cache-key-suffix: "lint"
      - uses: golangci/golangci-lint-action@v8
        with:
          version: v2.1

  build:
    needs: [test, lint]
    runs-on: ubuntu-latest
    steps:
      - uses: ./.github/actions/setup-go-project
        with:
          cache-key-suffix: "build"
      - run: make build
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –µ–¥–∏–Ω–æ–≥–æ action

### ‚úÖ –ü—Ä–æ—Å—Ç–æ—Ç–∞

- –û–¥–∏–Ω action –¥–ª—è –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ prepare/restore –ª–æ–≥–∏–∫–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–µ–º

### ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –ö—ç—à –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ–∂–¥—É jobs —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- –£–º–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

### ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
- –ü—Ä–æ—Å—Ç–∞—è –æ—Ç–ª–∞–¥–∫–∞

## üõ†Ô∏è –ü–æ–¥–¥–µ—Ä–∂–∫–∞

Action –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:

- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ Go
- –ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å (Linux, macOS, Windows)
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ì–∏–±–∫—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- –í—Å–µ —Ç–∏–ø—ã Go –ø—Ä–æ–µ–∫—Ç–æ–≤
